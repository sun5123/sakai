<?xml version="1.0" encoding="UTF-8"?>
	<!-- This file generated by Sakai App Builder -AZ -->
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	http://www.springframework.org/schema/tx 
	http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
	http://www.springframework.org/schema/aop 
	http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
	http://www.springframework.org/schema/util
	http://www.springframework.org/schema/util/spring-util-2.5.xsd"
	xmlns:util="http://www.springframework.org/schema/util">

	<!-- 初始化Spring上下文 -->
	<bean id="SpringContextUtil" class="org.sakaiproject.resource.util.SpringContextUtil" />
	<!-- 数据源配置 -->
	<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
		<property name="driverClassName" value="com.mysql.jdbc.Driver" />
		<property name="url"
			value="jdbc:mysql://localhost:3306/sakai112?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;autoReconnectForPools=true" />
		<property name="username" value="root" />
		<property name="password" value="123456" />
		<property name="initialSize" value="10" />
		<property name="maxActive" value="100" />
		<property name="maxIdle" value="30" />
		<property name="minIdle" value="10" />
		<property name="maxWait" value="6000" />
		<property name="removeAbandoned" value="true" />
		<property name="removeAbandonedTimeout" value="1800" />
		<property name="logAbandoned" value="true" />
		<property name="poolPreparedStatements" value="true" />
		<!--property name="connectionProperties" value="${datasource.connectionProperties}" /-->
		<property name="maxOpenPreparedStatements" value="150" />
		<property name="validationQuery" value="select 1 from dual" />
		<property name="testOnBorrow" value="true" />
		<property name="testOnReturn" value="false" />
		<property name="testWhileIdle" value="true" />
		<property name="timeBetweenEvictionRunsMillis" value="300000" />
		<property name="numTestsPerEvictionRun" value="3" />
		<property name="minEvictableIdleTimeMillis" value="1800000" />
	</bean>	
	
	<!-- Hibernate配置 -->
	<bean id="sessionFactory"
		class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
		<property name="dataSource" ref="dataSource" />
		<property name="hibernateProperties">
			<props>
				<prop key="hibernate.dialect">${hibernate.dialect}</prop>
				<prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
				<prop key="hibernate.cache.provider_class">${hibernate.cache.provider_class}</prop>
				<prop key="hibernate.query.substitutions">true 1, false 0</prop>
				<prop key="hibernate.hbm2ddl.auto">update</prop>
				<prop key="hibernate.connection.isolation">4</prop>
			</props>
		</property>

		<property name="mappingResources">
			<list>
				<value>
					org/sakaiproject/resource/api/file/model/ResourceFolderModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/file/model/ResourceFileModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/file/model/ResourceDownloadModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/courseware/model/CoursewareModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteCourseModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteModuleModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteForumModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteSectionModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteSelfTestModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteTestModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteForumRecordModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteModuleRecordModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteSectionRecordModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteSelftestAttemptModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteSelftestRecordModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteStudyRecordModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteTestAttemptModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteTestRecordModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteSectionRecordDetailModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteSectionRecordActivityModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/course/model/MeleteSakaiUserModel.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/study/model/MeleteStudyHistoryRecordModel.hbm.xml
				</value>
				<!--<value>
					org/sakaiproject/resource/api/test/model/Test.hbm.xml
				</value>
				<value>
					org/sakaiproject/resource/api/test/model/TestRecord.hbm.xml
				</value>-->
				<value>
					org/sakaiproject/resource/api/template/model/TemplateModel.hbm.xml
				</value>
			</list>
		</property>
	</bean>
	<bean id="dao" abstract="true">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	<!-- 常用变量配置 -->
	<!--
		如需增加一个配置项，可按如下步骤进行： 1、增加一个<entry key="" value=""
		/>。key是配置项的名称，value是配置项的值。
		2、在org.sakaiproject.resource.util.Constants类中按要求增加一个属性。
	-->
	<bean id="constantsSupport" class="org.sakaiproject.resource.util.ConstantsSupport">
		<property name="constants" ref="stringConstants"></property>
		<property name="serverConfigurationService" ref="org.sakaiproject.component.api.ServerConfigurationService" />
	</bean>
	<util:map id="stringConstants">
	 

	<entry key="sakai.resource.cache.name" value="org.sakaiproject.resource.util.CacheUtil" />
		<entry key="sakai.resource.path.mount" value="/home/sakai/mount" />
		<entry key="sakai.resource.context.static" value="/static" />
		<!-- 文件资源上传存放目录 -->
		<entry key="sakai.resource.file.path" value="/www/resource/files/" />
		<!-- 文件资源存放的uri用于文件下载 -->
		<entry key="sakai.resource.file.uri" value="/resource/files/" />
		<!-- 多类型文件限制时各类行文件用 "," 隔开  -->
		<entry key="sakai.resource.file.fileType" value="*.*" />
		<entry key="sakai.resource.file.fileSize" value="20480000" />
		<!-- 安全目录 用于存放上传的课件包-->
		<entry key="sakai.resource.secure.path" value="/secure/resource" />
		<!-- 上传的课件包存放的相对路径 -->
		<entry key="sakai.resource.course.resource.pack.path" value="scormUpload" />
		<!-- 上传课件包的后缀限制 -->
		<entry key="sakai.resource.course.fileType" value="*.zip;*.ZIP" />
		<!-- 上传课件包的大小 -->
		<entry key="sakai.resource.course.fileSize" value="314572800" />
		<!-- 共享目录 用于课程课件存放，文件资源存放，导出课件包存放 -->
		<entry key="sakai.resource.web.path" value="/www/resource" />
		<!-- 访问课件的页时在其相对路径前增加url前缀 -->
		<!-- <entry key="sakai.resource.section.url.prefix" value="http://jx2.buptnu.com.cn/static/resource/"/> -->
		<entry key="sakai.resource.section.url.prefix" value="/resource/"/>
		<!-- 课件资源中的页资源存放的相对路径 -->
		<entry key="sakai.resource.section.path" value="course" />
		<!-- 课程课件页面中引用的资源 url 用于观看课件 -->
		<!--<entry key="sakai.resource.course.path.uri" value="http://jx2.buptnu.com.cn/static/resource/course/" />-->
		<entry key="sakai.resource.course.path.uri" value="/resource/course/" />
		<!-- 课件导出路径 -->
		<entry key="sakai.resource.courseware.export.path" value="/www/resource/scormExport/" />
		<!-- 课件导出时课件包存放的url -->
		<entry key="sakai.resource.courseware.export.uri" value="/resource/scormExport/" />
		<!-- 保存课件预览的路径 -->
		<entry key="sakai.resource.courseware.preview.path" value="/www/resource/scormPreview/" />
		<!-- 查看课件的预览的路径 -->
		<entry key="sakai.resource.courseware.preview.uri" value="/resource/scormPreview/" />
		<!-- 用ckeditor编辑页时上传资源的根目录 -->
		<!--<entry key="sakai.resource.courseware.resource.uri" value="http://jx2.buptnu.com.cn/static/resource/res/" />-->
		<entry key="sakai.resource.courseware.resource.uri" value="/resource/res/" />
		<entry key="sakai.resource.courseware.resource.path" value="/www/resource/res/" /><!-- 课件引用资源存储路径 与ckfinder下的config.xml中的baseDir配置相同-->
		<entry key="sakai.resource.courseware.resource.image.folder" value="images/" /><!-- 课件引用资源中图片资源存储的目录 与ckfinder下的config.xml中的type中的对应的配置相同-->
		<entry key="sakai.resource.courseware.resource.image.ext" value="bmp,gif,jpeg,jpg,png" /><!-- 课件引用资源中图片文件后缀名 与ckfinder下的config.xml中的type中的对应的配置相同-->
		<entry key="sakai.resource.courseware.resource.flash.folder" value="flash/" /><!-- 课件引用资源中flash资源存储的目录 与ckfinder下的config.xml中的type中的对应的配置相同-->
		<entry key="sakai.resource.courseware.resource.flash.ext" value="swf,flv" /><!-- 课件引用资源中flash资源文件后缀 与ckfinder下的config.xml中的type中的对应的配置相同-->
		<entry key="sakai.resource.courseware.resource.file.folder" value="files/" /><!-- 课件引用资源中其他资源存储的目录 与ckfinder下的config.xml中的type中的对应的配置相同-->
		<entry key="sakai.resource.operateCount" value="20" />
		<!-- 学生端计时相关的时间间隔配置 -->
		<entry key="sakai.resource.submit.interval" value="600000" />
		<!--
		学生学习时向服务器提交的时间间隔 单位 毫秒
		-->
		<entry key="sakai.resource.prompt.interval" value="900000" />
		<!--
		学生学习时弹出是否继续学习提示框的时间间隔 单位 毫秒
		-->
		<entry key="sakai.resource.skip.interval" value="10000" />
		<!--
		弹出提示框后从没有操作到跳出学习页面的时间间隔 单位 毫秒
		-->
		<entry key="sakai.resource.pass.view" value="通过"/>
		<entry key="sakai.resource.notPass.view" value="未通过"/>
		
		<!-- 作业提交间间隔-默认配置-5分钟 -->
		<entry key="sakai.resource.test.mininterval" value="5" />
		
		<!-- 系统功能开关：是否记录学习当前位置 -->
		<entry key="sakai.resource.func.switch.studyhistory" value="false" />
		
		<!-- 模板 -->
		<entry key="sakai.resource.template.path.uri" value="/resource/templates/" />
		<entry key="sakai.resource.template.path.uri.relative" value="/resource/templates/" />
		<entry key="sakai.resource.template.path.dir" value="/www/resource/templates/" />
		
		<!-- 外部系统集成 -->
		<!-- 题库 -->
		<entry key="sakai.resource.outSys.exam.key.entry" value="examSystem" />
		<entry key="sakai.resource.outSys.exam.user" value="test1" />
		<entry key="sakai.resource.outSys.exam.url.base" value="http://218.249.255.9:9090" />
		<entry key="sakai.resource.outSys.exam.url.course" value="/data/exam/course/list?un=${key}" />
		<entry key="sakai.resource.outSys.exam.url.schema" value="/data/exam/schema/list/${courseId}?un=${key}" />
		<entry key="sakai.resource.outSys.exam.url.schema.view" value="/data/exam/schema/view/${schemaId}?un=${key}" />
		<entry key="sakai.resource.outSys.exam.url.paper" value="/data/exam/paper/${schemaId}/${count}/${type}?un=${key}" />
		<entry key="sakai.resource.outSys.exam.url.entry" value="/index.mvc?un=${key}&amp;course=${courseId}" />
		<!-- 资源 -->
		<entry key="sakai.resource.outSys.resSys.key.code" value="buptnu" />
		<entry key="sakai.resource.outSys.resSys.key.entry" value="buptnuRes2015" />
		<entry key="sakai.resource.outSys.resSys.user" value="" />
		<entry key="sakai.resource.outSys.resSys.url.base" value="http://218.249.255.9:9090/space" />
		<entry key="sakai.resource.outSys.resSys.url.course" value="/api/user/courses" />
		<entry key="sakai.resource.outSys.resSys.url.resource" value="/api/file/search" />
		<entry key="sakai.resource.outSys.resSys.url.entry" value="/index.html?un=${key}&amp;from=${code}&amp;course=${courseId}" />
		
	</util:map>
	<!-- 系统权限注册 -->
	<bean id="functionRegister" class="org.sakaiproject.resource.util.FunctionRegister" />

	<!-- 定义ehCache的工厂，并设置所使用的Cache name -->
	<!-- <bean id="defaultCacheManager"
		class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">
		<property name="configLocation" value="classpath:ehcache.xml" />
	</bean>
	<bean id="ehCache" class="org.springframework.cache.ehcache.EhCacheFactoryBean">
		 <property name="cacheManager">
			<ref local="defaultCacheManager" />
		</property> 
		<property name="cacheName" value="userCache" />
	</bean> -->
	<bean id="cacheUtil"
		class="org.sakaiproject.resource.util.CacheUtil">
		<!-- <property name="cache" ref="ehCache"></property> -->
		<property name="courseService" ref="courseService"></property>
		<property name="studyService" ref="studyService"></property>
	</bean>

	<bean id="testAction" scope="prototype"
		class="org.sakaiproject.resource.tool.test.action.TestAction">
		<property name="service" ref="testService"></property>
	</bean>
	<!--  阶段作业 -->
	<bean id="meleteTestAction" scope="prototype"
		class="org.sakaiproject.resource.tool.test.action.MeleteTestAction">
		<property name="courseService" ref="courseService"></property>
		<property name="studyService" ref="studyService"></property>
	</bean>
	
	<bean id="testService"
		class="org.sakaiproject.resource.impl.test.service.TestServiceImpl" parent="dao">
	</bean>

	<!-- 加载模块资源 -->
	<import resource="courseware-component.xml" />
	<import resource="file-component.xml" />
	<import resource="study-component.xml" />
	<import resource="course-component.xml" />
	<import resource="statistics-component.xml" />
	<import resource="studymanage-component.xml" />
	<import resource="template-component.xml" />
	<import resource="forum-component.xml" />
	<import resource="rest-component.xml" />
</beans>